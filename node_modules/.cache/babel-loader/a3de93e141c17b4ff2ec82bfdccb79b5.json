{"ast":null,"code":"var _jsxFileName = \"F:\\\\react-hostel-main\\\\src\\\\actions\\\\securityActions.js\";\nimport axios from \"axios\";\nimport { GET_ERRORS, SET_CURRENT_STUDENT, LOGOUT } from \"./types\";\nimport setJWTToken from \"../securityUtils/setJWTToken\";\nimport jwt_decode from \"jwt-decode\";\nimport { Redirect } from 'react-router-dom';\nexport const createNewStudent = (newStudent, history) => async dispatch => {\n  try {\n    await axios.post(`http://localhost:8080/api/register`, newStudent);\n    history.push(\"/login\");\n    dispatch({\n      type: GET_ERRORS,\n      payload: {}\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\nexport const logout = history => async dispatch => {\n  localStorage.removeItem('logged');\n  localStorage.removeItem('jwtToken'); /// history.push(\"/\");\n  // dispatch({ type: LOGOUT }); \n\n  /*#__PURE__*/\n  React.createElement(Redirect, {\n    to: \"/login\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 3\n    }\n  });\n};\nexport const login = (LoginRequest, history) => async dispatch => {\n  try {\n    const {\n      email,\n      password,\n      role1\n    } = LoginRequest;\n    const login = {\n      email,\n      password\n    };\n    console.log(login); // post => Login Request\n\n    if (role1 == 'student') {\n      const res = await axios.post(`http://localhost:8080/api/loginstudent`, login); // extract token from res.data\n\n      const {\n        token,\n        role\n      } = res.data; // store the token in the localStorage\n\n      localStorage.setItem(\"jwtToken\", token);\n      localStorage.setItem(\"logged\", true);\n      console.log(role); // set our token in header ***\n\n      setJWTToken(token); // decode token on React\n\n      const decoded = jwt_decode(token); // dispatch to our securityReducer\n\n      dispatch({\n        type: SET_CURRENT_STUDENT,\n        payload: decoded\n      });\n      history.push(\"/studentDashboard\");\n    } else if (role1 == 'warden') {\n      const res = await axios.post(`http://localhost:8080/api/loginwarden`, login); // extract token from res.data\n\n      const {\n        token,\n        role\n      } = res.data; // store the token in the localStorage\n\n      localStorage.setItem(\"jwtToken\", token);\n      console.log(role); // set our token in header ***\n\n      setJWTToken(token); // decode token on React\n\n      const decoded = jwt_decode(token); // dispatch to our securityReducer\n\n      dispatch({\n        type: SET_CURRENT_STUDENT,\n        payload: decoded\n      });\n      history.push(\"/wardenDashboard\");\n    } else if (role1 == 'admin') {\n      const res = await axios.post(`http://localhost:8080/api/loginadmin`, login); // extract token from res.data\n\n      const {\n        token,\n        role\n      } = res.data; // store the token in the localStorage\n\n      localStorage.setItem(\"jwtToken\", token);\n      console.log(role); // set our token in header ***\n\n      setJWTToken(token); // decode token on React\n\n      const decoded = jwt_decode(token); // dispatch to our securityReducer\n\n      dispatch({\n        type: SET_CURRENT_STUDENT,\n        payload: decoded\n      });\n      history.push(\"/adminDashboard\");\n    } else {\n      throw new Error('Who are you?');\n    }\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};","map":{"version":3,"sources":["F:/react-hostel-main/src/actions/securityActions.js"],"names":["axios","GET_ERRORS","SET_CURRENT_STUDENT","LOGOUT","setJWTToken","jwt_decode","Redirect","createNewStudent","newStudent","history","dispatch","post","push","type","payload","err","response","data","logout","localStorage","removeItem","login","LoginRequest","email","password","role1","console","log","res","token","role","setItem","decoded","Error"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport { GET_ERRORS,SET_CURRENT_STUDENT,LOGOUT} from \"./types\";\nimport setJWTToken from \"../securityUtils/setJWTToken\";\nimport jwt_decode from \"jwt-decode\";\nimport  { Redirect } from 'react-router-dom'\n\n\nexport const createNewStudent = (newStudent, history) => async dispatch => {\n  try {\n    await axios.post(`http://localhost:8080/api/register`, newStudent);\n    history.push(\"/login\");\n    dispatch({\n      type: GET_ERRORS,\n      payload: {}\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\n\nexport const logout = (history) => async dispatch => {\n  localStorage.removeItem('logged');\n  localStorage.removeItem('jwtToken');\n /// history.push(\"/\");\n // dispatch({ type: LOGOUT }); \n  <Redirect to='/login'  />\n}\n\n\nexport const login = (LoginRequest,history) => async dispatch => {\n  try {\n    const {email, password, role1} = LoginRequest;\n    const login = {email,password};\n    console.log(login);\n    // post => Login Request\n    if(role1 == 'student'){\n      const res = await axios.post(`http://localhost:8080/api/loginstudent`, login);\n      // extract token from res.data\n      const { token,role } = res.data;\n      // store the token in the localStorage\n      localStorage.setItem(\"jwtToken\", token);\n      localStorage.setItem(\"logged\", true);\n      console.log(role);\n      // set our token in header ***\n      setJWTToken(token);\n      // decode token on React\n      const decoded = jwt_decode(token);\n      // dispatch to our securityReducer\n      dispatch({\n        type: SET_CURRENT_STUDENT,\n        payload: decoded\n      });\n  \n      history.push(\"/studentDashboard\");\n    }\n    else if(role1 == 'warden'){\n      const res = await axios.post(`http://localhost:8080/api/loginwarden`, login);\n      // extract token from res.data\n      const { token,role } = res.data;\n      // store the token in the localStorage\n      localStorage.setItem(\"jwtToken\", token);\n      console.log(role);\n      // set our token in header ***\n      setJWTToken(token);\n      // decode token on React\n      const decoded = jwt_decode(token);\n      // dispatch to our securityReducer\n      dispatch({\n        type: SET_CURRENT_STUDENT,\n        payload: decoded\n      });\n  \n      history.push(\"/wardenDashboard\");\n    }else if(role1 == 'admin'){\n      const res = await axios.post(`http://localhost:8080/api/loginadmin`, login);\n      // extract token from res.data\n      const { token,role } = res.data;\n      // store the token in the localStorage\n      localStorage.setItem(\"jwtToken\", token);\n      console.log(role);\n      // set our token in header ***\n      setJWTToken(token);\n      // decode token on React\n      const decoded = jwt_decode(token);\n      // dispatch to our securityReducer\n      dispatch({\n        type: SET_CURRENT_STUDENT,\n        payload: decoded\n      });\n  \n      history.push(\"/adminDashboard\");\n    }else{\n      throw new Error('Who are you?')\n    }\n    \n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\n"]},"metadata":{},"sourceType":"module"}